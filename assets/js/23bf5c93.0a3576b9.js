"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[347],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return m}});var o=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=o.createContext({}),l=function(e){var t=o.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=l(e.components);return o.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},p=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,s=e.parentName,u=c(e,["components","mdxType","originalType","parentName"]),p=l(n),m=r,f=p["".concat(s,".").concat(m)]||p[m]||d[m]||a;return n?o.createElement(f,i(i({ref:t},u),{},{components:n})):o.createElement(f,i({ref:t},u))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,i=new Array(a);i[0]=p;var c={};for(var s in t)hasOwnProperty.call(t,s)&&(c[s]=t[s]);c.originalType=e,c.mdxType="string"==typeof e?e:r,i[1]=c;for(var l=2;l<a;l++)i[l]=n[l];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}p.displayName="MDXCreateElement"},3978:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return c},contentTitle:function(){return s},metadata:function(){return l},toc:function(){return u},default:function(){return p}});var o=n(7462),r=n(3366),a=(n(7294),n(3905)),i=["components"],c={title:"Validate Webhook Notifications"},s=void 0,l={unversionedId:"validate-webhook",id:"validate-webhook",title:"Validate Webhook Notifications",description:"Securing a Webhook. Optional but highly recommended.",source:"@site/docs/validate-webhook.md",sourceDirName:".",slug:"/validate-webhook",permalink:"/lodi-api-documentation/validate-webhook",tags:[],version:"current",frontMatter:{title:"Validate Webhook Notifications"},sidebar:"docs",previous:{title:"Overview",permalink:"/lodi-api-documentation/webhook"}},u=[{value:"Securing a Webhook. Optional but highly recommended.",id:"securing-a-webhook-optional-but-highly-recommended",children:[],level:2},{value:"NodeJS",id:"nodejs",children:[],level:2}],d={toc:u};function p(e){var t=e.components,n=(0,r.Z)(e,i);return(0,a.kt)("wrapper",(0,o.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"securing-a-webhook-optional-but-highly-recommended"},"Securing a Webhook. Optional but highly recommended."),(0,a.kt)("p",null,"Your server can optionally validate the webhook notifications to confirm that the LODI server sends them."),(0,a.kt)("p",null,"All webhook notifications sent to your server contain the ",(0,a.kt)("inlineCode",{parentName:"p"},"x-lodi-signature")," header. This header is an HMAC-SHA1 signature generated using your webhook request payload and your secret key. Your secret key will be provided to you by the LODI developer."),(0,a.kt)("p",null,"Please review the code examples below for guidance on performing signature verification."),(0,a.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,a.kt)("div",{parentName:"div",className:"admonition-heading"},(0,a.kt)("h5",{parentName:"div"},(0,a.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,a.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,a.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"IMPORTANT")),(0,a.kt)("div",{parentName:"div",className:"admonition-content"},(0,a.kt)("p",{parentName:"div"},"Please ensure to process raw body from the HTTP(s) POST request to validate the contents of the webhook payload."))),(0,a.kt)("h2",{id:"nodejs"},"NodeJS"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'const crypto = require(\'crypto\');\n\n// Get webhook payload as received by your server endpoint. It needs to be the raw payload coming from the HTTP POST body that came to your server endpoint.\nconst webhook_payload =\n  \'{"booking_status":{"booking_no":"220203-1E-0001","reference_no":"XXXXXX","status":"PICKUP COMPLETE","status_timestamp":"2022-02-03 08:33:28 AM"},"delivery_status":{"order":1,"is_rts":false,"status":"OUT FOR DELIVERY","status_timestamp":"2022-02-03 08:33:28 AM"},"rider":{"full_name":"Jay Remollo","contact_no":"9123456789"}}\';\n\n// Get your secret key\nconst SECRET_KEY = \'{your_secret_key}\';\n\nconst signature = crypto\n  .createHmac(\'sha1\', SECRET_KEY)\n  .update(webhook_payload)\n  .digest(\'hex\');\n\n// Verify signature from `x-lodi-signature` header\nconst webhook_payload_signature = \'{x-lodi-signature value}\';\n\nif (signature === webhook_payload_signature) {\n  console.log(\'Verification is successful\'); // webhook came from LODI server\n} else {\n  console.log(\'Verification failed\'); // webhook came from somewhere else, not LODI server\n}\n')))}p.isMDXComponent=!0}}]);